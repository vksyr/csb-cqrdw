{"version":3,"sources":["IncidentManager.js","index.js"],"names":["IncidentManager","props","dataSiteUrl","useState","companies","setCompanies","company","setCompany","group","setGroup","groupID","setGroupID","org","setOrg","serviceIDs","setServiceIDs","groups","setGroups","services","setServices","priorities","label","value","selectedPriorities","setSelectedPriorities","rowDetailID","setRowDetailID","show4HrContainmentView","setShow4HrContainmentView","showAgeKpi","setShowAgeKpi","ageKpiBtnCss","setAgeKpiBtnCss","ageKpiArrowColor","setAgeKpiArrowColor","ageKpiOptionsCss","setAgeKpiOptionsCss","kpiDateField","setKpiDateField","greenMaxAge","setGreenMaxAge","yellowMaxAge","setYellowMaxAge","redMaxAge","setRedMaxAge","dateFields","name","title","columns","setColumns","rows","setRows","expandedRowIDs","setExpandedRowIDs","React","useEffect","getGroups","getIncidents","length","filter","x","getServices","getCompanies","addKpiColumn","window","setTimeout","getCellValue","getKpi","concat","forEach","column","data","_color","grey","Age_KPI","indexOf","green","yellow","red","_text","_age","parseInt","Age_In_Minutes","_greenMaxAge","_yellowMaxAge","_redMaxAge","ex","sx","color","getKpiParams","dateFormatter","epoch","Intl","DateTimeFormat","year","month","day","format","DateTypeProvider","formatterComponent","fetch","headers","Accept","then","response","json","map","myJson","onShowAgeKpiClick","_rows","_rowIndex","findIndex","Incident_Number","_row","console","log","rowDetail","className","class","Description","PriorityCode","Detailed_Decription","First_Name","Last_Name","Department","StatusCode","Assigned_Group","style","maxWidth","overflow","borderLeft","WorkLog","item","i","borderBottom","Work_Log_Submit_Date","Work_Log_Submitter","Detailed_Description","onChange","val","options","option","obj","split","getOptionLabel","getOptionValue","service","some","isMulti","priority","paddingTop","type","checked","for","onClick","event","stopPropagation","fontSize","onInput","e","target","defaultCurrentPage","pageSize","defaultSorting","columnName","direction","expandedRowIds","onExpandedRowIdsChange","defaultValue","defaultHiddenColumnNames","showSortingControls","contentComponent","row","rootElement","document","getElementById","ReactDOM","render","href"],"mappings":"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","file":"static/js/main.73c72b53.chunk.js","sourcesContent":["import React, { useState } from \"react\";\nimport Select from \"react-select\";\nimport ArrowDropDownIcon from \"@mui/icons-material/ArrowDropDown\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport Circle from \"@mui/icons-material/Circle\";\nimport { grey, red, green, yellow } from \"@mui/material/colors\";\n\nimport {\n  SortingState,\n  IntegratedSorting,\n  SearchState,\n  IntegratedFiltering,\n  RowDetailState,\n  DataTypeProvider,\n  PagingState,\n  IntegratedPaging\n} from \"@devexpress/dx-react-grid\";\nimport {\n  Grid,\n  Table,\n  Toolbar,\n  SearchPanel,\n  TableHeaderRow,\n  TableRowDetail,\n  TableColumnVisibility,\n  PagingPanel\n} from \"@devexpress/dx-react-grid-material-ui\";\n\nimport \"bootstrap/dist/css/bootstrap.min.css\";\n\nexport default function IncidentManager(props) {\n  const dataSiteUrl = \"data/\";\n\n  const [companies, setCompanies] = useState([]);\n  const [company, setCompany] = useState(null);\n  const [group, setGroup] = useState(null);\n  const [groupID, setGroupID] = useState(null);\n  const [org, setOrg] = useState(null);\n  const [serviceIDs, setServiceIDs] = useState([]);\n  const [groups, setGroups] = useState([]);\n  const [services, setServices] = useState([]);\n  const priorities = [\n    { label: \"Low\", value: \"3\" },\n    { label: \"Medium\", value: \"2\" },\n    { label: \"High\", value: \"1\" },\n    { label: \"Critical\", value: \"0\" }\n  ];\n  const [selectedPriorities, setSelectedPriorities] = useState([\n    { label: \"Low\", value: \"3\" },\n    { label: \"Medium\", value: \"2\" },\n    { label: \"High\", value: \"1\" },\n    { label: \"Critical\", value: \"0\" }\n  ]);\n  const [rowDetailID, setRowDetailID] = useState(null);\n  const [rowDetails, setRowDetails] = useState([]);\n\n  const [show4HrContainmentView, setShow4HrContainmentView] = useState(false);\n  const [showAgeKpi, setShowAgeKpi] = useState(false);\n  const [ageKpiBtnCss, setAgeKpiBtnCss] = useState(\"disabled\");\n  const [ageKpiArrowColor, setAgeKpiArrowColor] = useState(\"disabled\");\n  const [ageKpiOptionsCss, setAgeKpiOptionsCss] = useState(\"disabled\");\n  const [kpiDateField, setKpiDateField] = useState(\"Submit_Date\");\n  const [greenMaxAge, setGreenMaxAge] = useState(90);\n  const [yellowMaxAge, setYellowMaxAge] = useState(180);\n  const [redMaxAge, setRedMaxAge] = useState(240);\n  const dropOffField = \"Required_Resolution_DateTime\";\n  const dateFields = [\n    { label: \"Submit Date\", value: \"Submit_Date\" },\n    { label: \"Last Modified\", value: \"Last_Modified_Date\" },\n    { label: \"Last Resolved\", value: \"Last_Resolved_Date\" },\n    { label: \"Reported Date\", value: \"Reported_Date\" },\n    { label: \"Responded Date\", value: \"Responded_Date\" },\n    { label: \"Closed Date\", value: \"Closed_Date\" },\n    { label: \"Event Date\", value: \"Event_Date\" },\n    { label: \"Required Resolution\", value: \"Required_Resolution_DateTime\" },\n    { label: \"Estimated Resolution\", value: \"Estimated_Resolution_Date\" },\n    { label: \"Acknowledgement Date\", value: \"Acknowledgment_Start_Date\" },\n    { label: \"Resolution Start Date\", value: \"Resolution_Start_Date\" },\n    { label: \"Last SLA Hold Date\", value: \"Last_SLA_Hold_Date\" },\n    { label: \"VIP Assignment Date\", value: \"VIPAssignmentDateTime\" },\n    { label: \"VIP Dispatch Date\", value: \"VIPDispatchDateTime\" }\n  ];\n\n  const [columns, setColumns] = useState([\n    { name: \"Age_In_Minutes\", title: \"Age_In_Minutes\" },\n    { name: \"Incident_Number\", title: \"Incident Number\" },\n    { name: \"PriorityCode\", title: \"Priority\" },\n    { name: \"Description\", title: \"Summary\" },\n    { name: \"Submit_Date\", title: \"Submitted\" },\n    { name: \"Last_Modified_Date\", title: \"Modified\" },\n    { name: \"Assigned_Company_Group\", title: \"Company/Group\" },\n    { name: \"Assignee\", title: \"Assignee\" },\n    { name: \"ServiceCI\", title: \"ServiceCI\" },\n    { name: \"StatusCode\", title: \"Status\" },\n    { name: \"LastLog\", title: \"Last Log Entry\" }\n  ]);\n\n  const [rows, setRows] = useState([]);\n  const [expandedRowIDs, setExpandedRowIDs] = useState([]);\n\n  React.useEffect(() => {\n    setRowDetailID(null);\n\n    if (company) {\n      getGroups();\n    }\n    if (company) {\n      getIncidents();\n    }\n\n    // check if 24 hr containment is still toggled\n    if (\n      selectedPriorities.length !== 2 ||\n      selectedPriorities.filter((x) => x.label === \"High\").length !== 1 ||\n      selectedPriorities.filter((x) => x.label === \"Critical\").length !== 1\n    ) {\n      setShow4HrContainmentView(false);\n    }\n  }, [company, groupID, serviceIDs, selectedPriorities]);\n\n  React.useEffect(() => {\n    getServices();\n  }, [company, groupID, selectedPriorities]);\n\n  React.useEffect(() => {\n    getCompanies();\n  }, []);\n\n  React.useEffect(() => {\n    setRowDetailID(null);\n    addKpiColumn();\n  }, [showAgeKpi]);\n\n  React.useEffect(() => {\n    setRowDetailID(null);\n\n    if (showAgeKpi) {\n      getIncidents();\n      setShowAgeKpi(false);\n      window.setTimeout(function () {\n        setShowAgeKpi(true);\n      }, 1);\n    }\n  }, [greenMaxAge, yellowMaxAge, redMaxAge, kpiDateField]);\n\n  const addKpiColumn = () => {\n    // remove\n    setColumns(columns.filter((x) => x.title !== \"Age\"));\n\n    if (showAgeKpi) {\n      // add column in grid\n      setColumns([{ getCellValue: getKpi, title: \"Age\" }].concat(columns)); // prepend to React State\n    } else setShow4HrContainmentView(false);\n  };\n\n  React.useEffect(() => {\n    setRowDetailID(null);\n\n    if (\n      ageKpiOptionsCss === \"disabled\" &&\n      (kpiDateField !== \"Submit_Date\" ||\n        greenMaxAge !== 90 ||\n        yellowMaxAge !== 180 ||\n        redMaxAge !== 240)\n    ) {\n      setShow4HrContainmentView(false);\n    }\n\n    if (ageKpiOptionsCss === \"disabled\") {\n      //setShowAgeKpi(true);\n    }\n  }, [ageKpiOptionsCss]);\n\n  React.useEffect(() => {\n    setRowDetailID(null);\n\n    if (show4HrContainmentView) {\n      setSelectedPriorities([\n        { label: \"High\", value: \"2\" },\n        { label: \"Critical\", value: \"3\" }\n      ]);\n      setKpiDateField(\"Event_Date\");\n      setGreenMaxAge(90);\n      setYellowMaxAge(180);\n      setRedMaxAge(240);\n      setShowAgeKpi(true);\n\n      columns\n        .filter((x) => x.title === \"Submitted\")\n        .forEach((column) => {\n          column.title = \"4-HR Start Date\";\n          column.name = kpiDateField;\n        });\n\n      // set service, company, group\n      setCompany(\"All\");\n      setGroup(\"All\");\n      setGroupID(\"All\");\n\n      //todo: highlight stuff blue\n    } else {\n      columns\n        .filter((x) => x.title === \"4-HR Start Date\")\n        .forEach((column) => {\n          column.title = \"Submitted\";\n          column.name = \"Submit_date\";\n        });\n    }\n  }, [show4HrContainmentView]);\n\n  let getKpi = (data) => {\n    let _color = grey[500];\n    if (data.Age_KPI.indexOf(\"green.gif\") !== -1) _color = green[500];\n    else if (data.Age_KPI.indexOf(\"yellow.gif\") !== -1) _color = yellow[500];\n    else if (data.Age_KPI.indexOf(\"red.gif\") !== -1) _color = red[500];\n\n    let _text = \"\";\n    let _age = 0;\n    try {\n      let _age = parseInt(data.Age_In_Minutes);\n      let _greenMaxAge = parseInt(greenMaxAge);\n      let _yellowMaxAge = parseInt(yellowMaxAge);\n      let _redMaxAge = parseInt(redMaxAge);\n\n      if (_age > _redMaxAge) {\n        _text = \"Exceeded!\";\n      } else if (_age > _yellowMaxAge) {\n        _text = \"-\" + (_redMaxAge - _age);\n      } else if (_age > _greenMaxAge) {\n        _text = \"-\" + (_yellowMaxAge - _age);\n      } else {\n        _text = \"-\" + (_greenMaxAge - _age);\n      }\n    } catch (ex) {}\n\n    return (\n      <div>\n        <Circle sx={{ color: _color }} /> {_text}\n      </div>\n    );\n  };\n\n  const getKpiParams = () => {\n    return `StartDateField%3D${kpiDateField};DropOffField%3D${dropOffField};GreenMaxAge%3D${greenMaxAge};YellowMaxAge%3D${yellowMaxAge};RedMaxAge%3D${redMaxAge}`;\n  };\n\n  const dateFormatter = (epoch) => {\n    let date = new Intl.DateTimeFormat(\"en-US\", {\n      year: \"numeric\",\n      month: \"2-digit\",\n      day: \"2-digit\"\n    }).format(epoch.value); // 01/11/2021\n    return date;\n  };\n\n  const DateTypeProvider = (props) => (\n    <DataTypeProvider formatterComponent={dateFormatter} {...props} />\n  );\n\n  const getCompanies = () => {\n    fetch(`${dataSiteUrl}companies.json?opCode=GetCompanies`, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\"\n      }\n    })\n      .then(function (response) {\n        return response.json();\n      })\n      .then(function (json) {\n        setCompanies([{ label: \"All\", value: \"All\" }].concat(json.data));\n      });\n  };\n\n  const getGroups = () => {\n    fetch(`${dataSiteUrl}groups.json?opCode=GetGroups&Company=${company}`, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\"\n      }\n    })\n      .then(function (response) {\n        return response.json();\n      })\n      .then(function (json) {\n        setGroups([{ label: \"All\", value: \"All|All\" }].concat(json.data));\n      });\n  };\n\n  const getServices = () => {\n    if (show4HrContainmentView) {\n      setServices([{ label: \"CyberSecurity\", value: \"CyberSecurity\" }]);\n      setServiceIDs([{ label: \"CyberSecurity\", value: \"CyberSecurity\" }]);\n    } else {\n      fetch(\n        `${dataSiteUrl}services.json?opCode=GetServices&Company=${company}&Org=${org}&GroupID=${groupID}&Priorities=${priorities.map(\n          (x) => x.value\n        )}&Filter=&KpiParams=${getKpiParams()}`,\n        {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Accept: \"application/json\"\n          }\n        }\n      )\n        .then(function (response) {\n          return response.json();\n        })\n        .then(function (myJson) {\n          setServices(myJson.data);\n        });\n    }\n  };\n\n  const getIncidents = () => {\n    fetch(\n      `${dataSiteUrl}incidents.json?opCode=GetIncidents&Company=${company}&Org=${org}&GroupID=${groupID}&Priorities=${priorities.map(\n        (x) => x.value\n      )}&Services=${services.map(\n        (x) => x.value\n      )}&Filter=&KpiParams=${getKpiParams()}`,\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Accept: \"application/json\"\n        }\n      }\n    )\n      .then(function (response) {\n        return response.json();\n      })\n      .then(function (myJson) {\n        setRows(myJson.data);\n      });\n  };\n\n  const onCompanyChange = (val) => {\n    setGroupID(null);\n    setServiceIDs([]);\n    setCompany(val.value);\n  };\n\n  const onGroupChange = (obj) => {\n    setGroup(obj.value);\n    if (obj.value.indexOf(\"|\") !== -1) {\n      setOrg(obj.value.split(\"|\")[0]);\n      setGroupID(obj.value.split(\"|\")[1]);\n    }\n  };\n\n  const onShowAgeKpiChange = (val) => {\n    setShowAgeKpi(!showAgeKpi);\n    if (!showAgeKpi) {\n      setAgeKpiArrowColor(\"primary\");\n      setAgeKpiBtnCss(\"active\");\n    } else {\n      // Style dropdown\n      setAgeKpiArrowColor(\"disabled\");\n      setAgeKpiBtnCss(\"disabled\");\n      setAgeKpiOptionsCss(\"disabled\");\n    }\n  };\n\n  const onShowAgeKpiClick = () => {\n    if (showAgeKpi) {\n      setAgeKpiOptionsCss(\n        ageKpiOptionsCss === \"enabled\" ? \"disabled\" : \"enabled\"\n      );\n      setAgeKpiBtnCss(ageKpiOptionsCss === \"enabled\" ? \"active\" : \"selected\");\n    }\n\n    if (ageKpiOptionsCss === \"enabled\") {\n      getIncidents();\n    }\n  };\n\n  React.useEffect(() => {\n    let _rows = rows;\n    let _rowIndex = _rows.findIndex((x) => x.Incident_Number === rowDetailID);\n    let _row = _rows[_rowIndex];\n\n    console.log(\"test\");\n\n    if (\n      rowDetailID != null &&\n      _rowIndex > -1 &&\n      _row.rowDetail === \"Loading...\"\n    ) {\n      fetch(\n        `${dataSiteUrl}incident.json?opCode=GetIncident&IncidentNumber=${rowDetailID}`,\n        {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Accept: \"application/json\"\n          }\n        }\n      )\n        .then(function (response) {\n          return response.json();\n        })\n        .then(function (json) {\n          _row.rowDetail = (\n            <div className=\"row\">\n              <div className=\"col-7\">\n                <div class=\"detail-field\">\n                  <strong>Summary:</strong>\n                  <br />\n                  {json.data.Description}\n                </div>\n                <div class=\"detail-field\">\n                  <strong>Priority:</strong>\n                  <br />\n                  {json.data.PriorityCode}\n                </div>\n                <div class=\"detail-field\">\n                  <strong>Notes:</strong>\n                  <br />\n                  {json.data.Detailed_Decription}\n                </div>\n                <div class=\"detail-field\">\n                  <strong>Customer/Office:</strong>\n                  <br />\n                  {json.data.First_Name} {json.data.Last_Name} /{\" \"}\n                  {json.data.Department}\n                </div>\n                <div class=\"detail-field\">\n                  <strong>Status:</strong>\n                  <br />\n                  {json.data.StatusCode}\n                </div>\n                <div class=\"detail-field\">\n                  <strong>Assigned Group:</strong>\n                  <br />\n                  {json.data.Assigned_Group}\n                </div>\n              </div>\n              <div\n                className=\"col-5\"\n                style={{\n                  maxWidth: 400,\n                  overflow: \"scroll-y\",\n                  borderLeft: \"1px solid #ced4da\"\n                }}\n              >\n                <div>\n                  {json.data.WorkLog?.map(function (item, i) {\n                    return (\n                      <div\n                        className=\"detail-field\"\n                        style={{\n                          borderBottom: \"1px solid #ced4da\"\n                        }}\n                      >\n                        <div class=\"worklog-header\">\n                          <strong>\n                            {dateFormatter(item.Work_Log_Submit_Date)}\n                          </strong>{\" \"}\n                          {item.Work_Log_Submitter}\n                        </div>\n                        <div class=\"worklog-body\">\n                          {item.Detailed_Description}\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            </div>\n          );\n\n          _rows[_rowIndex] = _row;\n\n          setRows([]); //hack to refresh component\n          setRows(_rows);\n        });\n    }\n  }, [rowDetailID, rows]);\n\n  const RowDetail = ({ row }) => {\n    setRowDetailID(row.Incident_Number);\n    let _rowIndex = rows.findIndex(\n      (x) => x.Incident_Number === row.Incident_Number\n    );\n    let _rows = rows;\n    let _row = _rows[_rowIndex];\n\n    if (!_row.rowDetail) {\n      _row.rowDetail = \"Loading...\";\n      _rows[_rowIndex] = _row;\n      setRows(_rows);\n    }\n\n    return rows[_rowIndex].rowDetail;\n  };\n\n  return (\n    <div>\n      <div class=\"filter-container\">\n        <form>\n          <label class=\"label-nowrap\">\n            Company:\n            <Select\n              className=\"companySel\"\n              onChange={onCompanyChange}\n              options={companies}\n              value={companies.filter(function (option) {\n                return option.value === company;\n              })}\n            ></Select>\n          </label>\n          <label>\n            Group:\n            <Select\n              className=\"groupSel\"\n              value={groups.filter(function (option) {\n                return option.value === group;\n              })}\n              onChange={onGroupChange}\n              options={groups}\n              getOptionLabel={(x) => x.label}\n              getOptionValue={(x) => x.value}\n            ></Select>\n          </label>\n          <label>\n            Services:\n            <Select\n              className=\"servicesSel\"\n              value={services.filter(function (service) {\n                return serviceIDs.some((x) => service.value === x.value);\n              })}\n              onChange={(val) => {\n                setShow4HrContainmentView(false);\n                setServiceIDs((serviceIDs) => {\n                  return val;\n                });\n              }}\n              options={services}\n              isMulti\n            ></Select>\n          </label>\n\n          <label>\n            Priorities:\n            <Select\n              value={priorities.filter(function (priority) {\n                return selectedPriorities.some(\n                  (x) => priority.value === x.value\n                );\n              })}\n              onChange={(val) => {\n                setSelectedPriorities((selectedPriorities) => {\n                  return val;\n                });\n              }}\n              options={priorities}\n              class=\"form-check-input\"\n              isMulti\n            ></Select>\n          </label>\n          <div style={{ paddingTop: 10 }}>\n            <label>\n              <div class=\"form-check form-switch\">\n                <input\n                  class=\"form-check-input\"\n                  type=\"checkbox\"\n                  checked={show4HrContainmentView}\n                  onChange={() =>\n                    setShow4HrContainmentView(!show4HrContainmentView)\n                  }\n                />\n                <label class=\"form-check-label\" for=\"flexSwitchCheckDefault\">\n                  Show 4HR-Containment View\n                </label>\n              </div>\n            </label>\n\n            <label>\n              <div class=\"form-check form-switch\">\n                <input\n                  class=\"form-check-input\"\n                  type=\"checkbox\"\n                  checked={showAgeKpi}\n                  onChange={onShowAgeKpiChange}\n                />\n                <label\n                  onClick={onShowAgeKpiClick}\n                  class={\"form-check-label age-kpi-btn-\" + ageKpiBtnCss}\n                  for=\"flexSwitchCheckDefault\"\n                >\n                  Show age indicators\n                  <ArrowDropDownIcon color={ageKpiArrowColor} />\n                  <div\n                    onClick={(event) => event.stopPropagation()}\n                    class={\"age-kpi-options-\" + ageKpiOptionsCss}\n                  >\n                    <span class=\"close-icon\" onClick={onShowAgeKpiClick}>\n                      <CloseIcon fontSize=\"small\" />\n                    </span>\n                    <div class=\"label-nowrap\">\n                      Age field:&nbsp;\n                      <label>\n                        <Select\n                          onChange={(val) => setKpiDateField(val.value)}\n                          options={dateFields}\n                          value={dateFields.filter(function (option) {\n                            return option.value === kpiDateField;\n                          })}\n                        ></Select>\n                      </label>\n                      <br />\n                      Green Max Age:&nbsp;\n                      <label>\n                        <input\n                          value={greenMaxAge}\n                          onInput={(e) => setGreenMaxAge(e.target.value)}\n                          type=\"text\"\n                          class=\"form-control\"\n                        />\n                      </label>\n                      <br />\n                      Yellow Max Age:&nbsp;\n                      <label>\n                        <input\n                          value={yellowMaxAge}\n                          onInput={(e) => setYellowMaxAge(e.target.value)}\n                          type=\"text\"\n                          class=\"form-control\"\n                        />\n                      </label>\n                      <br />\n                      Red Max Age:&nbsp;\n                      <label>\n                        <input\n                          value={redMaxAge}\n                          onInput={(e) => setRedMaxAge(e.target.value)}\n                          type=\"text\"\n                          class=\"form-control\"\n                        />\n                      </label>\n                    </div>\n                    <span class=\"footer\">* in minutes</span>\n                  </div>\n                </label>\n              </div>\n            </label>\n          </div>\n        </form>\n      </div>\n      <div class=\"grid\">\n        <Grid rows={rows} columns={columns}>\n          <PagingState defaultCurrentPage={0} pageSize={20} />\n          <IntegratedPaging />\n          <SortingState\n            defaultSorting={[{ columnName: \"Name\", direction: \"asc\" }]}\n          />\n          <IntegratedSorting />\n          <RowDetailState\n            expandedRowIds={expandedRowIDs}\n            onExpandedRowIdsChange={setExpandedRowIDs}\n          />\n          <SearchState defaultValue=\"\" />\n          <IntegratedFiltering />\n          <DateTypeProvider for={dateFields.map((x) => x.value)} />\n          <Table />\n          <TableColumnVisibility\n            defaultHiddenColumnNames={[\"Age_In_Minutes\"]}\n          />\n          <TableHeaderRow showSortingControls />\n          <PagingPanel />\n          <TableRowDetail contentComponent={RowDetail} />\n        </Grid>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport IncidentManager from \"./IncidentManager.js\";\n\nimport \"./styles.css\";\n\nconst rootElement = document.getElementById(\"root\");\n\nReactDOM.render(\n  <div>\n    <nav class=\"navbar navbar-default\">\n      <div class=\"container-fluid\">\n        <a class=\"navbar-brand\" href=\"#\">\n          Incident Manager\n        </a>\n      </div>\n    </nav>\n    <IncidentManager />\n  </div>,\n  rootElement\n);\n"],"sourceRoot":""}